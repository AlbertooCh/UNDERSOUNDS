{% extends 'base.html' %}
{% load static %}
{% block title %}{{ album.title }} - {{ album.artist_name }} | Undersounds{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'music/css/album_detail.css' %}">
{% endblock %}

{% block content %}
<div class="album-detail">
    <div class="album-header">
        {% if album.album_cover %}
            <img src="{{ album.album_cover.url }}" alt="{{ album.title }}" class="album-cover">
        {% else %}
            <img src="{% static 'images/default_album.png' %}" alt="Álbum sin portada" class="album-cover">
        {% endif %}

        <div class="album-info">
            <h1 class="album-title">{{ album.title }}</h1>
            <h2 class="album-artist">{{ album.artist_name }}</h2>

            <div class="album-meta">
                <span>{{ album.release_date|date:"Y" }}</span>
                <span>{{ songs.count }} canción{{ songs.count|pluralize:"es" }}</span>
                <span>{{ album.genre }}</span>
            </div>

            {% if album.description %}
                <div class="album-description">
                    <p>{{ album.description }}</p>
                </div>
            {% endif %}

            <div class="action-buttons">
                {% if request.user.is_authenticated and request.user.artist_name == album.artist_name %}
                    <a href="{% url 'edit_album' album.id %}" class="btn btn-secondary">Editar Álbum</a>
                {% endif %}
                <a href="#" class="btn btn-primary">Comprar Álbum ({{ album.price }}€)</a>
            </div>
        </div>
    </div>

   <div class="song-list">
    <h3>Lista de canciones</h3>

    {% if songs %}
        {% for song in songs %}
            <div class="song-item">
                <div class="song-number">{{ forloop.counter }}</div>
                {% if song.song_cover %}
                    <img src="{{ song.song_cover.url }}" alt="{{ song.title }}" class="song-cover">
                {% else %}
                    <img src="{% static 'images/default_song.png' %}" alt="Canción sin portada" class="song-cover">
                {% endif %}
                <div class="song-info">
                    <div class="song-title">{{ song.title }}</div>
                    <div class="song-artist">{{ song.artist_name }}</div>
                </div>
                <div class="song-price">{{ song.price }}€</div>
                <div class="song-actions">
                    <a href="{% url 'music_detail_id' song.id %}" class="btn btn-secondary">Ver canción</a>
                </div>
            </div>
        {% endfor %}
    {% else %}
        <p class="empty-message">Este álbum no contiene canciones aún.</p>
    {% endif %}
</div>
</div>
{% endblock %}